<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Shopping Store</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f2f2f2;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #2874f0;
      color: white;
      padding: 15px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      font-weight: bold;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }

    .header-top {
      width: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 1.5em;
    }

    .nav-links {
      display: flex;
      gap: 15px;
      margin-top: 8px;
      align-self: flex-end;
    }

    .nav-links a {
      color: white;
      text-decoration: none;
      background-color: #1f5fd1;
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 0.9rem;
      transition: background 0.3s ease;
    }

    .nav-links a:hover {
      background-color: #174bb0;
    }

    header a#cart-icon {
      color: white;
      text-decoration: none;
      background-color: #2874f0;
      padding: 10px 15px;
      border-radius: 50%;
      font-weight: bold;
      font-size: 1.5rem;
      position: relative;
    }

    #cart-count {
      position: absolute;
      top: -5px;
      right: -5px;
      background: red;
      color: white;
      font-size: 0.7rem;
      padding: 3px 6px;
      border-radius: 50%;
      display: none;
      border: 2px solid white;
    }

    .search-bar {
      width: 100%;
      display: flex;
      justify-content: center;
      margin-top: 10px;
    }

    #search-input {
      width: 80%;
      max-width: 400px;
      padding: 10px 15px;
      font-size: 1rem;
      border: 2px solid #ddd;
      border-radius: 20px;
      outline: none;
      transition: 0.3s;
    }

    #search-input:focus {
      border-color: #2874f0;
      box-shadow: 0 0 5px rgba(40, 116, 240, 0.5);
    }

    .location-bar {
      display: flex;
      align-items: center;
      background-color: white;
      color: #333;
      border-radius: 5px;
      padding: 5px 10px;
      margin-top: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      font-size: 0.85rem;
      gap: 6px;
    }

    .container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 30px;
      padding: 40px 20px;
    }

    .product {
      background: white;
      width: 280px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      overflow: hidden;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
    }

    .product:hover {
      transform: translateY(-5px);
    }

    .product img {
      width: 100%;
      height: 230px;
      object-fit: cover;
    }

    .details {
      padding: 10px;
    }

    .details h2 {
      font-size: 1.1em;
      margin: 10px 0 5px;
      color: #333;
    }

    .price {
      color: green;
      font-size: 1.1em;
    }

    footer {
      background-color: white;
      text-align: center;
      padding: 15px;
      color: #777;
      box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
    }

    /* MODAL STYLES */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.6);
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background: white;
      border-radius: 10px;
      width: 90%;
      max-width: 600px;
      padding: 20px;
      position: relative;
      text-align: center;
      animation: fadeIn 0.3s ease;
    }

    .close-btn {
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 1.5rem;
      cursor: pointer;
    }

    .modal-images {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 15px;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
    }

    .modal-images img {
      width: 100%;
      max-width: 180px;
      height: 150px;
      border-radius: 8px;
      object-fit: cover;
      scroll-snap-align: center;
    }

    .btn {
      background-color: #ff9f00;
      border: none;
      color: white;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      margin: 5px;
    }

    .btn:hover {
      background-color: #fb641b;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }
  </style>
</head>
<body>

  <header>
    <div class="header-top">
      üõçÔ∏è My Shopping Store
      <a href="cart.html" id="cart-icon">üõí<span id="cart-count"></span></a>
    </div>

    <!-- üëá Added Navigation Links -->
    <div class="nav-links">
      <a href="login.html">Login</a>
      <a href="signup.html">Sign Up</a>
      <a href="admin.html">Admin Panel</a>
    </div>

    <div class="search-bar">
      <input type="text" id="search-input" placeholder="Search products..." onkeyup="searchProducts()">
    </div>

    <div class="location-bar">
      <span>üè†</span>
      <span class="location-text" id="current-location">Home - Faridabad</span>
      <span class="location-change" onclick="changeLocation()">Change</span>
    </div>
  </header>

  <div class="container"></div>

  <!-- Product Modal -->
  <div class="modal" id="productModal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeModal()">‚úñ</span>
      <div class="modal-images" id="modalImages"></div>
      <h2 id="modalName"></h2>
      <div class="price" id="modalPrice"></div>
      <div id="modalStock"></div>
      <button class="btn" id="addCartBtn">Add to Cart</button>
      <button class="btn" style="background-color:#388e3c;">Buy Now</button>
    </div>
  </div>

  <footer>¬© 2025 My Shopping Store | All Rights Reserved</footer>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <script>
    const cartCount = document.getElementById('cart-count');
    const modal = document.getElementById('productModal');
    const modalName = document.getElementById('modalName');
    const modalPrice = document.getElementById('modalPrice');
    const modalImages = document.getElementById('modalImages');
    const modalStock = document.getElementById('modalStock');
    const addCartBtn = document.getElementById('addCartBtn');

    function updateCartCount() {
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
      cartCount.style.display = totalItems > 0 ? 'inline-block' : 'none';
      cartCount.textContent = totalItems;
    }

    function searchProducts() {
      const input = document.getElementById('search-input').value.toLowerCase();
      const products = document.querySelectorAll('.product');
      products.forEach(product => {
        const name = product.querySelector('h2').textContent.toLowerCase();
        product.style.display = name.includes(input) ? 'block' : 'none';
      });
    }

    function changeLocation() {
      const newLoc = prompt("Enter your delivery location:", localStorage.getItem('userLocation') || "Faridabad");
      if (newLoc) {
        document.getElementById('current-location').textContent = `Home - ${newLoc}`;
        localStorage.setItem('userLocation', newLoc);
      }
    }

    function loadProducts() {
      const container = document.querySelector('.container');
      container.innerHTML = '';

      const products = JSON.parse(localStorage.getItem('products')) || [];
      if (products.length === 0) {
        container.innerHTML = '<p style="text-align:center;">No products available. Add some in the admin panel.</p>';
        return;
      }

      products.forEach((p, i) => {
        let mainImg = '';

        if (Array.isArray(p.images) && p.images.length > 0) {
          mainImg = p.images[0];
        } else if (p.image) {
          mainImg = p.image;
        } else {
          mainImg = 'images/default.jpg';
        }

        const productHTML = `
          <div class="product" onclick="openModal(${i})">
            <img src="${mainImg}" alt="${p.name}">
            <div class="details">
              <h2>${p.name}</h2>
              <div class="price">‚Çπ${p.price}</div>
            </div>
          </div>
        `;
        container.innerHTML += productHTML;
      });
    }

    function openModal(index) {
      const products = JSON.parse(localStorage.getItem('products')) || [];
      const p = products[index];

      modalName.textContent = p.name;
      modalPrice.textContent = `‚Çπ${p.price}`;
      
      const imgs = Array.isArray(p.images) && p.images.length > 0 ? p.images 
                  : p.image ? [p.image] 
                  : ['images/default.jpg'];

      modalImages.innerHTML = imgs.map(img => `<img src="${img}" alt="${p.name}">`).join('');

      modalStock.innerHTML = p.stock && p.stock < 6 ? `<div style="color:red;font-weight:bold;">Only few left!</div>` : '';

      addCartBtn.onclick = () => {
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        const existing = cart.find(item => item.name === p.name);
        if (existing) existing.quantity += 1;
        else cart.push({ name: p.name, price: p.price, image: imgs[0], quantity: 1 });
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartCount();
        confetti({ particleCount: 80, spread: 70, origin: { y: 0.6 } });
      };

      modal.style.display = 'flex';
    }

    function closeModal() {
      modal.style.display = 'none';
    }

    window.onclick = (e) => {
      if (e.target === modal) closeModal();
    };

    window.onload = function() {
      updateCartCount();
      loadProducts();
      const savedLoc = localStorage.getItem('userLocation');
      if (savedLoc) document.getElementById('current-location').textContent = `Home - ${savedLoc}`;
    };
  </script>
</body>
</html>
